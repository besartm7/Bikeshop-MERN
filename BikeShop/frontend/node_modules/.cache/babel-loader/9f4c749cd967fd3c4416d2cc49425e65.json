{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"C:/Users/realmadrid/Desktop/BikeShop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/realmadrid/Desktop/BikeShop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/realmadrid/Desktop/BikeShop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import axios from'axios';import{useDispatch,useSelector}from'react-redux';import{Form,Button,Card,Image,Row,Col}from'react-bootstrap';import FormLargeContainer from'../../components/FormLargeContainer';import Message from'../../components/Message';import Loader from'../../components/Loader';import ExtractBikeColor from'../../components/ExtractBikeColor';import{ColorExtractor}from'react-color-extractor';import{deleteBike,detailsBike,updateBike}from'../../actions/bikeAction';import{BIKE_UPDATE_RESET}from'../../constants/bikeConstants';var EditBikeView=function EditBikeView(_ref){var match=_ref.match,history=_ref.history;var bikeId=match.params.id;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var defaultImg='/images/default.jpg';var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),brand=_useState6[0],setBrand=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),price=_useState10[0],setPrice=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),countInStock=_useState12[0],setCountInStock=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),colors=_useState14[0],setColors=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),description=_useState16[0],setDescription=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),uploading=_useState18[0],setUploading=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),newUpload=_useState20[0],setNewUpload=_useState20[1];var _useState21=useState(''),_useState22=_slicedToArray(_useState21,2),fileUpload=_useState22[0],setFileUpload=_useState22[1];var dispatch=useDispatch();var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var bikeDetails=useSelector(function(state){return state.bikeDetails;});var loading=bikeDetails.loading,error=bikeDetails.error,bike=bikeDetails.bike;var bikeUpdate=useSelector(function(state){return state.bikeUpdate;});var loadingUpdate=bikeUpdate.loading,errorUpdate=bikeUpdate.error,successUpdate=bikeUpdate.success;useEffect(function(){if(!userInfo||!userInfo.isAdmin){history.push('/login');}else{if(successUpdate){dispatch({type:BIKE_UPDATE_RESET});dispatch(detailsBike(bikeId));}else{if(bike&&bike._id!==bikeId){dispatch(detailsBike(bikeId));}else{setImage(bike.image);setName(bike.name);setBrand(bike.brand);setCategory(bike.category);setPrice(bike.price);setCountInStock(bike.countInStock);setDescription(bike.description);setColors(bike.colors);}}}},[dispatch,history,bikeId,successUpdate,bike,userInfo]);var deleteHandler=function deleteHandler(id){if(window.confirm('Are you sure?')){dispatch(deleteBike(id));history.push('/admin/bikelist');}};var uploadFileHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,formData,config,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];setFileUpload(file);formData=new FormData();formData.append('image',file);setUploading(true);_context.prev=5;config={headers:{'Content-Type':'multipart/form-data'}};_context.next=9;return axios.post('/api/upload',formData,config);case 9:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setImage(data);setUploading(false);setNewUpload(true);_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](5);console.error(_context.t0);setUploading(false);case 20:case\"end\":return _context.stop();}}},_callee,null,[[5,16]]);}));return function uploadFileHandler(_x){return _ref2.apply(this,arguments);};}();var removeColorHandler=function removeColorHandler(e){var filteredColors=colors.filter(function(color){return color!==e;});setColors(filteredColors);};var submitHandler=function submitHandler(e){e.preventDefault();dispatch(updateBike({_id:bikeId,image:image,name:name,brand:brand,category:category,price:price,countInStock:countInStock,description:description,colors:colors}));};return/*#__PURE__*/_jsx(FormLargeContainer,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-center mb-5\",children:[\"Edit Bike \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-bicycle\"})]}),loadingUpdate&&/*#__PURE__*/_jsx(Loader,{}),errorUpdate&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorUpdate}),loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,className:\"col-sm-12\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"image\",children:[/*#__PURE__*/_jsx(Col,{xs:12,md:3,children:/*#__PURE__*/_jsx(Image,{src:fileUpload?URL.createObjectURL(fileUpload):\"\".concat(bike.image)?\"\".concat(bike.image):defaultImg,alt:bike.name,style:{width:100},thumbnail:true})}),/*#__PURE__*/_jsxs(Col,{xs:12,md:9,children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Upload bike image:\"}),/*#__PURE__*/_jsx(Form.File,{id:\"image-file\",label:image?image:'Choose File',custom:true,onChange:uploadFileHandler,children:uploading&&/*#__PURE__*/_jsx(Loader,{})})]})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"colors\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,xs:12,md:3,children:\"Colors:\"}),/*#__PURE__*/_jsxs(Col,{xs:12,md:9,className:\"editbike-colors\",children:[/*#__PURE__*/_jsx(ColorExtractor,{src:newUpload?URL.createObjectURL(fileUpload):\"\".concat(bike.image)?\"\".concat(bike.image):null,getColors:function getColors(colorsArray){if(newUpload){setColors(colorsArray);setNewUpload(false);}}}),/*#__PURE__*/_jsx(ExtractBikeColor,{bikeColors:colors||[],removeColorHandler:removeColorHandler})]})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,xs:12,md:3,children:\"Name:\"}),/*#__PURE__*/_jsx(Col,{xs:12,md:9,children:/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"name\",value:name,onChange:function onChange(e){return setName(e.target.value);}})})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"brand\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,xs:12,md:3,children:\"Brand:\"}),/*#__PURE__*/_jsx(Col,{xs:12,md:9,children:/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"brand\",value:brand,onChange:function onChange(e){return setBrand(e.target.value);}})})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"category\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,xs:12,md:3,children:\"Category:\"}),/*#__PURE__*/_jsx(Col,{xs:12,md:9,children:/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"category\",value:category,onChange:function onChange(e){return setCategory(e.target.value);}})})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"price\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,xs:12,md:3,children:\"Price:\"}),/*#__PURE__*/_jsx(Col,{xs:12,md:9,children:/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"price\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"countInStock\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,xs:12,md:3,children:\"Count in Stock:\"}),/*#__PURE__*/_jsx(Col,{xs:12,md:9,children:/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"count in stock\",value:countInStock,onChange:function onChange(e){return setCountInStock(e.target.value);}})})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,controlId:\"Description\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,xs:12,md:3,children:\"Description:\"}),/*#__PURE__*/_jsx(Col,{xs:12,md:9,children:/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:3,placeholder:\"description\",value:description,onChange:function onChange(e){return setDescription(e.target.value);}})})]}),/*#__PURE__*/_jsxs(Row,{className:\"mt-5\",children:[/*#__PURE__*/_jsx(Col,{xs:6,className:\"text-right\",children:/*#__PURE__*/_jsxs(Button,{type:\"submit\",variant:\"outline-dark\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\",children:\" \"}),\"Update\"]})}),/*#__PURE__*/_jsx(Col,{xs:6,className:\"text-left\",children:/*#__PURE__*/_jsxs(Button,{variant:\"outline-danger\",onClick:function onClick(){return deleteHandler(bike._id);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash\",children:\" \"}),\" Delete\"]})})]})]})]})})});};export default EditBikeView;","map":{"version":3,"sources":["C:/Users/realmadrid/Desktop/BikeShop/frontend/src/layout/admin/EditBikeView.js"],"names":["React","useEffect","useState","axios","useDispatch","useSelector","Form","Button","Card","Image","Row","Col","FormLargeContainer","Message","Loader","ExtractBikeColor","ColorExtractor","deleteBike","detailsBike","updateBike","BIKE_UPDATE_RESET","EditBikeView","match","history","bikeId","params","id","image","setImage","defaultImg","name","setName","brand","setBrand","category","setCategory","price","setPrice","countInStock","setCountInStock","colors","setColors","description","setDescription","uploading","setUploading","newUpload","setNewUpload","fileUpload","setFileUpload","dispatch","userLogin","state","userInfo","bikeDetails","loading","error","bike","bikeUpdate","loadingUpdate","errorUpdate","successUpdate","success","isAdmin","push","type","_id","deleteHandler","window","confirm","uploadFileHandler","e","file","target","files","formData","FormData","append","config","headers","post","data","console","removeColorHandler","filteredColors","filter","color","submitHandler","preventDefault","URL","createObjectURL","width","colorsArray","value"],"mappings":"ikBAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,CAA0BC,QAA1B,KAAyC,OAAzC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,IAAT,CAAeC,MAAf,CAAuBC,IAAvB,CAA6BC,KAA7B,CAAoCC,GAApC,CAAyCC,GAAzC,KAAmD,iBAAnD,CACA,MAAOC,CAAAA,kBAAP,KAA+B,qCAA/B,CACA,MAAOC,CAAAA,OAAP,KAAoB,0BAApB,CACA,MAAOC,CAAAA,MAAP,KAAmB,yBAAnB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,mCAA7B,CACA,OAASC,cAAT,KAA+B,uBAA/B,CACA,OAASC,UAAT,CAAqBC,WAArB,CAAkCC,UAAlC,KAAoD,0BAApD,CACA,OAASC,iBAAT,KAAkC,+BAAlC,CAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAsB,IAApBC,CAAAA,KAAoB,MAApBA,KAAoB,CAAbC,OAAa,MAAbA,OAAa,CACvC,GAAMC,CAAAA,MAAM,CAAGF,KAAK,CAACG,MAAN,CAAaC,EAA5B,CADuC,cAGdxB,QAAQ,CAAC,EAAD,CAHM,wCAGjCyB,KAHiC,eAG1BC,QAH0B,eAIvC,GAAMC,CAAAA,UAAU,CAAG,qBAAnB,CAJuC,eAKhB3B,QAAQ,CAAC,EAAD,CALQ,yCAKjC4B,IALiC,eAK3BC,OAL2B,8BAMd7B,QAAQ,CAAC,EAAD,CANM,yCAMjC8B,KANiC,eAM1BC,QAN0B,8BAOR/B,QAAQ,CAAC,EAAD,CAPA,yCAOjCgC,QAPiC,eAOvBC,WAPuB,8BAQdjC,QAAQ,CAAC,CAAD,CARM,0CAQjCkC,KARiC,gBAQ1BC,QAR0B,gCASAnC,QAAQ,CAAC,CAAD,CATR,2CASjCoC,YATiC,gBASnBC,eATmB,gCAUZrC,QAAQ,CAAC,EAAD,CAVI,2CAUjCsC,MAViC,gBAUzBC,SAVyB,gCAWFvC,QAAQ,CAAC,EAAD,CAXN,2CAWjCwC,WAXiC,gBAWpBC,cAXoB,gCAYNzC,QAAQ,CAAC,KAAD,CAZF,2CAYjC0C,SAZiC,gBAYtBC,YAZsB,gCAaN3C,QAAQ,CAAC,KAAD,CAbF,2CAajC4C,SAbiC,gBAatBC,YAbsB,gCAcJ7C,QAAQ,CAAC,EAAD,CAdJ,2CAcjC8C,UAdiC,gBAcrBC,aAdqB,gBAgBvC,GAAMC,CAAAA,QAAQ,CAAG9C,WAAW,EAA5B,CAEA,GAAM+C,CAAAA,SAAS,CAAG9C,WAAW,CAAC,SAAA+C,KAAK,QAAIA,CAAAA,KAAK,CAACD,SAAV,EAAN,CAA7B,CAlBuC,GAmB/BE,CAAAA,QAnB+B,CAmBlBF,SAnBkB,CAmB/BE,QAnB+B,CAqBvC,GAAMC,CAAAA,WAAW,CAAGjD,WAAW,CAAC,SAAA+C,KAAK,QAAIA,CAAAA,KAAK,CAACE,WAAV,EAAN,CAA/B,CArBuC,GAsBhCC,CAAAA,OAtBgC,CAsBRD,WAtBQ,CAsBhCC,OAtBgC,CAsBvBC,KAtBuB,CAsBRF,WAtBQ,CAsBvBE,KAtBuB,CAsBhBC,IAtBgB,CAsBRH,WAtBQ,CAsBhBG,IAtBgB,CAwBvC,GAAMC,CAAAA,UAAU,CAAGrD,WAAW,CAAC,SAAA+C,KAAK,QAAIA,CAAAA,KAAK,CAACM,UAAV,EAAN,CAA9B,CAxBuC,GAyBvBC,CAAAA,aAzBuB,CAyBsCD,UAzBtC,CAyBhCH,OAzBgC,CAyBDK,WAzBC,CAyBsCF,UAzBtC,CAyBRF,KAzBQ,CAyBqBK,aAzBrB,CAyBsCH,UAzBtC,CAyBYI,OAzBZ,CA4BvC7D,SAAS,CAAC,UAAI,CACV,GAAG,CAACoD,QAAD,EAAa,CAACA,QAAQ,CAACU,OAA1B,CAAkC,CAC9BxC,OAAO,CAACyC,IAAR,CAAa,QAAb,EACH,CAFD,IAEK,CACD,GAAGH,aAAH,CAAiB,CACbX,QAAQ,CAAC,CAAEe,IAAI,CAAE7C,iBAAR,CAAD,CAAR,CACA8B,QAAQ,CAAChC,WAAW,CAACM,MAAD,CAAZ,CAAR,CACH,CAHD,IAGK,CACD,GAAGiC,IAAI,EAAIA,IAAI,CAACS,GAAL,GAAa1C,MAAxB,CAA+B,CAC3B0B,QAAQ,CAAChC,WAAW,CAACM,MAAD,CAAZ,CAAR,CACH,CAFD,IAEK,CACDI,QAAQ,CAAC6B,IAAI,CAAC9B,KAAN,CAAR,CACAI,OAAO,CAAC0B,IAAI,CAAC3B,IAAN,CAAP,CACAG,QAAQ,CAACwB,IAAI,CAACzB,KAAN,CAAR,CACAG,WAAW,CAACsB,IAAI,CAACvB,QAAN,CAAX,CACAG,QAAQ,CAACoB,IAAI,CAACrB,KAAN,CAAR,CACAG,eAAe,CAACkB,IAAI,CAACnB,YAAN,CAAf,CACAK,cAAc,CAACc,IAAI,CAACf,WAAN,CAAd,CACAD,SAAS,CAACgB,IAAI,CAACjB,MAAN,CAAT,CACH,CACJ,CACJ,CACJ,CAtBQ,CAsBP,CAACU,QAAD,CAAW3B,OAAX,CAAoBC,MAApB,CAA4BqC,aAA5B,CAA2CJ,IAA3C,CAAiDJ,QAAjD,CAtBO,CAAT,CAwBA,GAAMc,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACzC,EAAD,CAAO,CACzB,GAAG0C,MAAM,CAACC,OAAP,CAAe,eAAf,CAAH,CAAmC,CAC/BnB,QAAQ,CAACjC,UAAU,CAACS,EAAD,CAAX,CAAR,CACAH,OAAO,CAACyC,IAAR,CAAa,iBAAb,EACH,CACJ,CALD,CAOA,GAAMM,CAAAA,iBAAiB,2FAAG,iBAAOC,CAAP,kKAChBC,IADgB,CACVD,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CADU,CAEtBzB,aAAa,CAACuB,IAAD,CAAb,CACMG,QAHgB,CAGL,GAAIC,CAAAA,QAAJ,EAHK,CAItBD,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBL,IAAzB,EACA3B,YAAY,CAAC,IAAD,CAAZ,CALsB,gBAQZiC,MARY,CAQH,CACXC,OAAO,CAAC,CACJ,eAAgB,qBADZ,CADG,CARG,uBAaK5E,CAAAA,KAAK,CAAC6E,IAAN,CAAW,aAAX,CAA0BL,QAA1B,CAAoCG,MAApC,CAbL,wCAaVG,IAbU,mBAaVA,IAbU,CAelBrD,QAAQ,CAACqD,IAAD,CAAR,CACApC,YAAY,CAAC,KAAD,CAAZ,CACAE,YAAY,CAAC,IAAD,CAAZ,CAjBkB,iFAmBlBmC,OAAO,CAAC1B,KAAR,cACAX,YAAY,CAAC,KAAD,CAAZ,CApBkB,qEAAH,kBAAjByB,CAAAA,iBAAiB,6CAAvB,CAwBA,GAAMa,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACZ,CAAD,CAAM,CAC7B,GAAMa,CAAAA,cAAc,CAAG5C,MAAM,CAAC6C,MAAP,CAAc,SAAAC,KAAK,QAAIA,CAAAA,KAAK,GAAKf,CAAd,EAAnB,CAAvB,CACA9B,SAAS,CAAC2C,cAAD,CAAT,CACH,CAHD,CAKA,GAAMG,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAAChB,CAAD,CAAK,CACvBA,CAAC,CAACiB,cAAF,GACAtC,QAAQ,CAAC/B,UAAU,CAAC,CAChB+C,GAAG,CAAE1C,MADW,CAEhBG,KAAK,CAALA,KAFgB,CAGhBG,IAAI,CAAJA,IAHgB,CAIhBE,KAAK,CAALA,KAJgB,CAKhBE,QAAQ,CAARA,QALgB,CAMhBE,KAAK,CAALA,KANgB,CAOhBE,YAAY,CAAZA,YAPgB,CAQhBI,WAAW,CAAXA,WARgB,CAShBF,MAAM,CAANA,MATgB,CAAD,CAAX,CAAR,CAWH,CAbD,CAeA,mBACI,KAAC,kBAAD,wBACI,KAAC,IAAD,wBACI,MAAC,IAAD,CAAM,IAAN,yBACI,YAAI,SAAS,CAAC,kBAAd,qCAA2C,UAAG,SAAS,CAAC,gBAAb,EAA3C,GADJ,CAEKmB,aAAa,eAAI,KAAC,MAAD,IAFtB,CAGKC,WAAW,eAAI,KAAC,OAAD,EAAS,OAAO,CAAC,QAAjB,UAA2BA,WAA3B,EAHpB,CAIKL,OAAO,cAAG,KAAC,MAAD,IAAH,CAAgBC,KAAK,cAAG,KAAC,OAAD,EAAS,OAAO,CAAC,QAAjB,UAA2BA,KAA3B,EAAH,cAC7B,MAAC,IAAD,EAAM,QAAQ,CAAE+B,aAAhB,CAA+B,SAAS,CAAC,WAAzC,wBACI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAE7E,GAAhB,CAAqB,SAAS,CAAC,OAA/B,wBACI,KAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,uBACI,KAAC,KAAD,EACI,GAAG,CAAEsC,UAAU,CACLyC,GAAG,CAACC,eAAJ,CAAoB1C,UAApB,CADK,CAEL,UAAGS,IAAI,CAAC9B,KAAR,YACG8B,IAAI,CAAC9B,KADR,EAEAE,UALd,CAOI,GAAG,CAAE4B,IAAI,CAAC3B,IAPd,CAQI,KAAK,CAAE,CAAC6D,KAAK,CAAE,GAAR,CARX,CASI,SAAS,KATb,EADJ,EADJ,cAeI,MAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,wBACI,KAAC,IAAD,CAAM,KAAN,iCADJ,cAEI,KAAC,IAAD,CAAM,IAAN,EACI,EAAE,CAAC,YADP,CAEI,KAAK,CAAEhE,KAAK,CAAGA,KAAH,CAAW,aAF3B,CAGI,MAAM,KAHV,CAII,QAAQ,CAAE2C,iBAJd,UAKE1B,SAAS,eAAI,KAAC,MAAD,IALf,EAFJ,GAfJ,GADJ,cA2BI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAElC,GAAhB,CAAqB,SAAS,CAAC,QAA/B,wBACI,KAAC,IAAD,CAAM,KAAN,EAAY,MAAM,KAAlB,CAAmB,EAAE,CAAE,EAAvB,CAA2B,EAAE,CAAE,CAA/B,qBADJ,cAEI,MAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,CAAoB,SAAS,CAAC,iBAA9B,wBAEI,KAAC,cAAD,EACI,GAAG,CAAEoC,SAAS,CACR2C,GAAG,CAACC,eAAJ,CAAoB1C,UAApB,CADQ,CAER,UAAGS,IAAI,CAAC9B,KAAR,YACG8B,IAAI,CAAC9B,KADR,EAEA,IALV,CAOI,SAAS,CAAE,mBAAAiE,WAAW,CAAI,CACtB,GAAG9C,SAAH,CAAa,CACTL,SAAS,CAACmD,WAAD,CAAT,CACA7C,YAAY,CAAC,KAAD,CAAZ,CACH,CAEJ,CAbL,EAFJ,cAiBI,KAAC,gBAAD,EAAkB,UAAU,CAAEP,MAAM,EAAI,EAAxC,CAA4C,kBAAkB,CAAE2C,kBAAhE,EAjBJ,GAFJ,GA3BJ,cAiDI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEzE,GAAhB,CAAqB,SAAS,CAAC,MAA/B,wBACI,KAAC,IAAD,CAAM,KAAN,EAAY,MAAM,KAAlB,CAAmB,EAAE,CAAE,EAAvB,CAA2B,EAAE,CAAE,CAA/B,mBADJ,cAEI,KAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,uBACI,KAAC,IAAD,CAAM,OAAN,EACI,IAAI,CAAC,MADT,CAEI,WAAW,CAAC,MAFhB,CAGI,KAAK,CAAEoB,IAHX,CAII,QAAQ,CAAE,kBAACyC,CAAD,QAAOxC,CAAAA,OAAO,CAACwC,CAAC,CAACE,MAAF,CAASoB,KAAV,CAAd,EAJd,EADJ,EAFJ,GAjDJ,cA6DI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEnF,GAAhB,CAAqB,SAAS,CAAC,OAA/B,wBACI,KAAC,IAAD,CAAM,KAAN,EAAY,MAAM,KAAlB,CAAmB,EAAE,CAAE,EAAvB,CAA2B,EAAE,CAAE,CAA/B,oBADJ,cAEI,KAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,uBACI,KAAC,IAAD,CAAM,OAAN,EACI,IAAI,CAAC,MADT,CAEI,WAAW,CAAC,OAFhB,CAGI,KAAK,CAAEsB,KAHX,CAII,QAAQ,CAAE,kBAACuC,CAAD,QAAOtC,CAAAA,QAAQ,CAACsC,CAAC,CAACE,MAAF,CAASoB,KAAV,CAAf,EAJd,EADJ,EAFJ,GA7DJ,cAwEI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEnF,GAAhB,CAAqB,SAAS,CAAC,UAA/B,wBACI,KAAC,IAAD,CAAM,KAAN,EAAY,MAAM,KAAlB,CAAmB,EAAE,CAAE,EAAvB,CAA2B,EAAE,CAAE,CAA/B,uBADJ,cAEI,KAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,uBACI,KAAC,IAAD,CAAM,OAAN,EACI,IAAI,CAAC,MADT,CAEI,WAAW,CAAC,UAFhB,CAGI,KAAK,CAAEwB,QAHX,CAII,QAAQ,CAAE,kBAACqC,CAAD,QAAOpC,CAAAA,WAAW,CAACoC,CAAC,CAACE,MAAF,CAASoB,KAAV,CAAlB,EAJd,EADJ,EAFJ,GAxEJ,cAmFI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEnF,GAAhB,CAAqB,SAAS,CAAC,OAA/B,wBACI,KAAC,IAAD,CAAM,KAAN,EAAY,MAAM,KAAlB,CAAmB,EAAE,CAAE,EAAvB,CAA2B,EAAE,CAAE,CAA/B,oBADJ,cAEI,KAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,uBACI,KAAC,IAAD,CAAM,OAAN,EACI,IAAI,CAAC,QADT,CAEI,WAAW,CAAC,OAFhB,CAGI,KAAK,CAAE0B,KAHX,CAII,QAAQ,CAAE,kBAACmC,CAAD,QAAOlC,CAAAA,QAAQ,CAACkC,CAAC,CAACE,MAAF,CAASoB,KAAV,CAAf,EAJd,EADJ,EAFJ,GAnFJ,cA8FI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEnF,GAAhB,CAAqB,SAAS,CAAC,cAA/B,wBACI,KAAC,IAAD,CAAM,KAAN,EAAY,MAAM,KAAlB,CAAmB,EAAE,CAAE,EAAvB,CAA2B,EAAE,CAAE,CAA/B,6BADJ,cAEI,KAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,uBACI,KAAC,IAAD,CAAM,OAAN,EACI,IAAI,CAAC,QADT,CAEI,WAAW,CAAC,gBAFhB,CAGI,KAAK,CAAE4B,YAHX,CAII,QAAQ,CAAE,kBAACiC,CAAD,QAAOhC,CAAAA,eAAe,CAACgC,CAAC,CAACE,MAAF,CAASoB,KAAV,CAAtB,EAJd,EADJ,EAFJ,GA9FJ,cAyGI,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEnF,GAAhB,CAAqB,SAAS,CAAC,aAA/B,wBACI,KAAC,IAAD,CAAM,KAAN,EAAY,MAAM,KAAlB,CAAmB,EAAE,CAAE,EAAvB,CAA2B,EAAE,CAAE,CAA/B,0BADJ,cAEI,KAAC,GAAD,EAAK,EAAE,CAAE,EAAT,CAAa,EAAE,CAAE,CAAjB,uBACI,KAAC,IAAD,CAAM,OAAN,EACI,EAAE,CAAC,UADP,CAEI,IAAI,CAAE,CAFV,CAGI,WAAW,CAAC,aAHhB,CAII,KAAK,CAAEgC,WAJX,CAKI,QAAQ,CAAE,kBAAC6B,CAAD,QAAO5B,CAAAA,cAAc,CAAC4B,CAAC,CAACE,MAAF,CAASoB,KAAV,CAArB,EALd,EADJ,EAFJ,GAzGJ,cAqHI,MAAC,GAAD,EAAK,SAAS,CAAC,MAAf,wBACI,KAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,SAAS,CAAC,YAAtB,uBACI,MAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,OAAO,CAAC,cAA9B,wBACI,UAAG,SAAS,CAAC,aAAb,eADJ,YADJ,EADJ,cAOI,KAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,SAAS,CAAC,WAAtB,uBACI,MAAC,MAAD,EAAQ,OAAO,CAAC,gBAAhB,CAAiC,OAAO,CAAE,yBAAM1B,CAAAA,aAAa,CAACV,IAAI,CAACS,GAAN,CAAnB,EAA1C,wBACI,UAAG,SAAS,CAAC,cAAb,eADJ,aADJ,EAPJ,GArHJ,GALJ,GADJ,EADJ,EADJ,CAgJH,CAvPD,CAyPA,cAAe7C,CAAAA,YAAf","sourcesContent":["import React,{ useEffect, useState} from 'react'\r\nimport axios from 'axios'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { Form, Button, Card, Image, Row, Col} from 'react-bootstrap'\r\nimport FormLargeContainer from '../../components/FormLargeContainer'\r\nimport Message from '../../components/Message'\r\nimport Loader from '../../components/Loader'\r\nimport ExtractBikeColor from '../../components/ExtractBikeColor'\r\nimport { ColorExtractor } from 'react-color-extractor'\r\nimport { deleteBike, detailsBike, updateBike } from '../../actions/bikeAction'\r\nimport { BIKE_UPDATE_RESET } from '../../constants/bikeConstants'\r\n\r\nconst EditBikeView = ({match, history}) => {\r\n    const bikeId = match.params.id\r\n\r\n    const[image, setImage] = useState('')\r\n    const defaultImg = '/images/default.jpg'\r\n    const[name, setName] = useState('')\r\n    const[brand, setBrand] = useState('')\r\n    const[category, setCategory] = useState('')\r\n    const[price, setPrice] = useState(0)\r\n    const[countInStock, setCountInStock] = useState(0)\r\n    const[colors, setColors] = useState([])\r\n    const[description, setDescription] = useState('')\r\n    const[uploading, setUploading] = useState(false)\r\n    const[newUpload, setNewUpload] = useState(false)\r\n    const[fileUpload, setFileUpload] = useState('')\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const userLogin = useSelector(state => state.userLogin)\r\n    const { userInfo } = userLogin\r\n    \r\n    const bikeDetails = useSelector(state => state.bikeDetails)\r\n    const {loading, error, bike} = bikeDetails\r\n\r\n    const bikeUpdate = useSelector(state => state.bikeUpdate)\r\n    const {loading: loadingUpdate, error: errorUpdate, success: successUpdate} = bikeUpdate\r\n\r\n\r\n    useEffect(()=>{\r\n        if(!userInfo || !userInfo.isAdmin){\r\n            history.push('/login')\r\n        }else{\r\n            if(successUpdate){\r\n                dispatch({ type: BIKE_UPDATE_RESET })\r\n                dispatch(detailsBike(bikeId))\r\n            }else{\r\n                if(bike && bike._id !== bikeId){\r\n                    dispatch(detailsBike(bikeId))\r\n                }else{\r\n                    setImage(bike.image)\r\n                    setName(bike.name)\r\n                    setBrand(bike.brand)\r\n                    setCategory(bike.category)\r\n                    setPrice(bike.price)\r\n                    setCountInStock(bike.countInStock)\r\n                    setDescription(bike.description)\r\n                    setColors(bike.colors)\r\n                }\r\n            }\r\n        }  \r\n    },[dispatch, history, bikeId, successUpdate, bike, userInfo])\r\n\r\n    const deleteHandler = (id) =>{\r\n        if(window.confirm('Are you sure?')){\r\n            dispatch(deleteBike(id))\r\n            history.push('/admin/bikelist')\r\n        }\r\n    }\r\n\r\n    const uploadFileHandler = async (e) =>{\r\n        const file= e.target.files[0]\r\n        setFileUpload(file)\r\n        const formData = new FormData()\r\n        formData.append('image', file)\r\n        setUploading(true)\r\n\r\n        try {\r\n            const config = {\r\n                headers:{\r\n                    'Content-Type': 'multipart/form-data'\r\n                } \r\n            }\r\n            const { data } = await axios.post('/api/upload', formData, config)\r\n\r\n            setImage(data)\r\n            setUploading(false)\r\n            setNewUpload(true)\r\n        } catch (error) {\r\n            console.error(error)\r\n            setUploading(false)\r\n        }\r\n    }\r\n\r\n    const removeColorHandler = (e) =>{\r\n        const filteredColors = colors.filter(color => color !== e)\r\n        setColors(filteredColors)\r\n    }\r\n\r\n    const submitHandler = (e)=>{\r\n        e.preventDefault()\r\n        dispatch(updateBike({\r\n            _id: bikeId,\r\n            image,\r\n            name,\r\n            brand, \r\n            category,\r\n            price,\r\n            countInStock,\r\n            description,\r\n            colors\r\n        }))\r\n    }\r\n\r\n    return (\r\n        <FormLargeContainer>\r\n            <Card>\r\n                <Card.Body>\r\n                    <h3 className='text-center mb-5'>Edit Bike <i className='fas fa-bicycle'></i></h3>\r\n                    {loadingUpdate && <Loader />}\r\n                    {errorUpdate && <Message variant='danger'>{errorUpdate}</Message>}\r\n                    {loading ? <Loader /> : error ? <Message variant='danger'>{error}</Message> :(\r\n                    <Form onSubmit={submitHandler} className='col-sm-12'>\r\n                        <Form.Group as={Row} controlId='image'>\r\n                            <Col xs={12} md={3}>\r\n                                <Image \r\n                                    src={fileUpload \r\n                                            ? URL.createObjectURL(fileUpload) \r\n                                            : `${bike.image}`\r\n                                            ? `${bike.image}` \r\n                                            : defaultImg\r\n                                        } \r\n                                    alt={bike.name} \r\n                                    style={{width: 100}} \r\n                                    thumbnail\r\n                                        \r\n                                />\r\n                            </Col>\r\n                            <Col xs={12} md={9}>\r\n                                <Form.Label>Upload bike image:</Form.Label> \r\n                                <Form.File \r\n                                    id='image-file' \r\n                                    label={image ? image : 'Choose File'} \r\n                                    custom \r\n                                    onChange={uploadFileHandler}\r\n                                >{uploading && <Loader />}</Form.File>\r\n                            </Col>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Row} controlId='colors'>\r\n                            <Form.Label column xs={12} md={3}>Colors:</Form.Label>\r\n                            <Col xs={12} md={9} className='editbike-colors'>\r\n                                \r\n                                <ColorExtractor\r\n                                    src={newUpload \r\n                                        ? URL.createObjectURL(fileUpload) \r\n                                        : `${bike.image}`\r\n                                        ? `${bike.image}` \r\n                                        : null\r\n                                    } \r\n                                    getColors={colorsArray => {\r\n                                        if(newUpload){\r\n                                            setColors(colorsArray)\r\n                                            setNewUpload(false)\r\n                                        }\r\n                                            \r\n                                    }}\r\n                                />\r\n                                <ExtractBikeColor bikeColors={colors || []} removeColorHandler={removeColorHandler} />\r\n                            </Col>\r\n                        </Form.Group>\r\n                        <Form.Group as={Row} controlId='name'>\r\n                            <Form.Label column xs={12} md={3}>Name:</Form.Label>\r\n                            <Col xs={12} md={9}>\r\n                                <Form.Control\r\n                                    type='text' \r\n                                    placeholder='name' \r\n                                    value={name} \r\n                                    onChange={(e) => setName(e.target.value)}\r\n                                >    \r\n                                </Form.Control>\r\n                            </Col>\r\n                        </Form.Group>\r\n                        <Form.Group as={Row} controlId='brand'>\r\n                            <Form.Label column xs={12} md={3}>Brand:</Form.Label>\r\n                            <Col xs={12} md={9}>\r\n                                <Form.Control \r\n                                    type='text' \r\n                                    placeholder='brand' \r\n                                    value={brand} \r\n                                    onChange={(e) => setBrand(e.target.value)}\r\n                                ></Form.Control>\r\n                            </Col>\r\n                        </Form.Group>\r\n                        <Form.Group as={Row} controlId='category'>\r\n                            <Form.Label column xs={12} md={3}>Category:</Form.Label>\r\n                            <Col xs={12} md={9}>\r\n                                <Form.Control \r\n                                    type='text' \r\n                                    placeholder='category' \r\n                                    value={category} \r\n                                    onChange={(e) => setCategory(e.target.value)}\r\n                                ></Form.Control>\r\n                            </Col>\r\n                        </Form.Group>\r\n                        <Form.Group as={Row} controlId='price'>\r\n                            <Form.Label column xs={12} md={3}>Price:</Form.Label>\r\n                            <Col xs={12} md={9}>\r\n                                <Form.Control \r\n                                    type='number' \r\n                                    placeholder='price' \r\n                                    value={price} \r\n                                    onChange={(e) => setPrice(e.target.value)}\r\n                                ></Form.Control>\r\n                            </Col>\r\n                        </Form.Group>\r\n                        <Form.Group as={Row} controlId='countInStock'>\r\n                            <Form.Label column xs={12} md={3}>Count in Stock:</Form.Label>\r\n                            <Col xs={12} md={9}>\r\n                                <Form.Control \r\n                                    type='number' \r\n                                    placeholder='count in stock' \r\n                                    value={countInStock} \r\n                                    onChange={(e) => setCountInStock(e.target.value)}\r\n                                ></Form.Control>\r\n                            </Col>\r\n                        </Form.Group>\r\n                        <Form.Group as={Row} controlId='Description'>\r\n                            <Form.Label column xs={12} md={3}>Description:</Form.Label>\r\n                            <Col xs={12} md={9}>\r\n                                <Form.Control \r\n                                    as='textarea'\r\n                                    rows={3}\r\n                                    placeholder='description' \r\n                                    value={description} \r\n                                    onChange={(e) => setDescription(e.target.value)}\r\n                                ></Form.Control>\r\n                            </Col>\r\n                        </Form.Group>\r\n                        <Row className='mt-5'>\r\n                            <Col xs={6} className=\"text-right\">\r\n                                <Button type='submit' variant='outline-dark'>\r\n                                    <i className='fas fa-edit'> </i> \r\n                                    Update\r\n                                </Button>\r\n                            </Col>\r\n                            <Col xs={6} className=\"text-left\">\r\n                                <Button variant='outline-danger' onClick={() => deleteHandler(bike._id)}>\r\n                                    <i className='fas fa-trash'> </i> Delete\r\n                                </Button>\r\n                            </Col>\r\n                        </Row>\r\n                    </Form>\r\n                    )}\r\n                </Card.Body>\r\n            </Card>\r\n        </FormLargeContainer>\r\n    )\r\n}\r\n\r\nexport default EditBikeView\r\n"]},"metadata":{},"sourceType":"module"}